stream cipher use bluetooth protocol generat sequenc pseudorandom number combin datum use xor oper key length may vari general bit iter generat bit use four shift regist differ length bit two intern state bit long clock tick regist shift two state updat current state previous state valu shift regist four bit extract shift regist add togeth algorithm xor sum valu bit regist first bit result output encod divid three part setup initi state bluetooth use structur random bit stream generat thus deal two combin algorithm initi bit state produc first stage use four input bit key bluetooth address bit bit master counter output process polynomi oper result key go second stage generat stream use encod key variabl length alway multipl bit bit key general use store second stage shift regist pseudorandom bit produc clock tick last bit insert shift regist stream generat initi state sever attack attempt cryptanalysi bluetooth protocol make number vulner find miia hermelin kaisa nyberg show could break oper instead bit output know type attack subsequ improv kishan chand gupta palash sarkar scott fluhrer cisco system employe find theoret attack oper precalcul key search complex oper deduc maxim secur equival provid bit key long key improv secur fluhrer attack improv upon earli work golic bagini morgari devis oper attack finn juha vainio show problem relat misus general possibl vulner bluetooth yi lu serg vaudenay publish statist attack requir first bit bluetooth frame frame bit long final complex retriev key oper attack improv oper precomput actual key search lu mei vaudenay publish cryptanalysi base condit correl attack good result requir first bit frame comput recov key author assert clear fast practic knownplaintext attack bluetooth encrypt compar exist attack