stream cipher plaintext bit combin cipher bit stream exclusiveor oper xor secur use properlycit need howev vulner attack certain precaut follow stream cipher vulner attack key use twice depth two say send messag length encrypt use key stream cipher produc string bit ck length messag encrypt version messag xor perform bit bit say adversari intercept ea eb easili comput howev xor commut properti xor selfinvers one messag long adversari truncat long messag size short attack reveal portion long messag word anyon intercept two messag encrypt key recov xor form run key cipher even neither messag know long messag natur languag cipher often break paperandpencil method world war ii british cryptanalyst john tiltman accomplish lorenz cipher dub tunni averag person comput cipher usual break matter minut one messag know solut trivial anoth situat recoveri trivial trafficflow secur measur station send continu stream cipher bit null charact eg ltrs baudot send real traffic common militari communic case transmiss channel fulli load good likelihood one ciphertext stream null nsa go great length prevent key use twice sera encrypt system often includ punch card reader load key mechan would automat cut card half card remov prevent reus one way avoid problem use initi vector iv send clear combin secret master key creat onetim key stream cipher sever common system use popular stream cipher rc includ wire equival privaci wep wifi protect access wpa ciphersab one mani problem wep iv short bit mean high likelihood iv would use twice thousand packet send master key see birthday attack subject packet duplic iv key reus attack problem fix wpa chang master key frequent suppos adversari know exact content part one messag part man middl attack replay attack alter content messag without know key say exampl know portion messag say electron fund transfer contain ascii string chang xore portion ciphertext string xor see work consid cipher text send ck xor new messag adversari creat recal string xore produc zero string zero xore anoth string leav string intact result ck xor ciphertext would correct amount bitflip attack prevent includ messag authent code increas likelihood tamper detect stream cipher combin secret key agre initi vector iv produc pseudorandom sequenc timetotim resynchron chosen iv attack reli find particular iv take togeth probabl reveal inform secret key typic multipl pair iv choos differ generat keystream analys statist linear correl andor algebra boolean relat see also differenti cryptanalysi choos particular valu initi vector expos nonrandom pattern generat sequenc attack comput bit thus shorten effect key length symptom attack would frequent resynchronis modern stream cipher includ step adequ mix secret key initi vector usual perform mani initi round